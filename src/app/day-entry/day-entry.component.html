<div class="day-entry" [class.invalid]="!isValid()">
  <div class="entry-field">
    <p-calendar
      [(ngModel)]="localDay.date"
      (onSelect)="onFieldChange('date', $event)"
      dateFormat="yy-mm-dd"
      [showIcon]="true"
      styleClass="w-full"
      [class]="!isValid() ? 'ng-invalid ng-dirty' : ''">
    </p-calendar>
  </div>
  
  <div class="entry-field">
    <p-dropdown
      [options]="activityOptions"
      [(ngModel)]="localDay.code"
      (onChange)="onFieldChange('code', $event.value, true)"
      [class]="!isCodeValid ? 'ng-invalid ng-dirty' : ''"
      placeholder="Seleziona codice"
      styleClass="w-full">
    </p-dropdown>
    @if (!isCodeValid) {
      <p-message severity="error" text="Codice attività obbligatorio" styleClass="mt-1"></p-message>
    }
  </div>
  
  <div class="entry-field">
    <input 
      type="text" 
      pInputText
      [(ngModel)]="localDay.activity"
      (ngModelChange)="onFieldChange('activity', $event)"
      placeholder="Descrizione attività"
      class="w-full">
  </div>
  
  @if (shouldShowExtract()) {
    <div class="entry-field">
      <p-dropdown
        [options]="extractOptions"
        [(ngModel)]="localDay.extract"
        (onChange)="onFieldChange('extract', $event.value)"
        placeholder="Seleziona estratto"
        styleClass="w-full">
      </p-dropdown>
    </div>
  }
  
  <div class="entry-field">
    <input 
      type="text" 
      pInputText
      [(ngModel)]="localDay.client"
      (ngModelChange)="onFieldChange('client', $event)"
      placeholder="Cliente"
      class="w-full">
  </div>
  
  <div class="entry-field">
    <p-inputNumber
      [(ngModel)]="localDay.hours"
      (onInput)="onFieldChange('hours', $event.value, true)"
      mode="decimal"
      [min]="0.125"
      [max]="8"
      [minFractionDigits]="3"
      [maxFractionDigits]="3"
      [class]="!isHoursValid ? 'ng-invalid ng-dirty' : ''"
      placeholder="0.000"
      styleClass="w-full">
    </p-inputNumber>
    @if (!isHoursValid) {
      <p-message severity="error" text="Ore obbligatorie (0.125 - 8)" styleClass="mt-1"></p-message>
    }
  </div>
  
  <div class="entry-field">
    <input 
      type="text" 
      pInputText
      [(ngModel)]="localDay.notes"
      (ngModelChange)="onFieldChange('notes', $event)"
      placeholder="Note"
      class="w-full">
  </div>
  
  <div class="entry-field actions">
    <p-button 
      icon="pi pi-times" 
      styleClass="p-button-danger p-button-text p-button-sm"
      (onClick)="onRemove()"
      [rounded]="true">
    </p-button>
  </div>
</div>